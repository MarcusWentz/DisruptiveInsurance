{"ast":null,"code":"import _regeneratorRuntime from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import Web3 from\"web3\";import{CONTRACT_ADDRESS,ABI,CONTRACT_ERC20_CHAINLINK_ADDRESS,CHAINLINK_ABI}from\"../config\";import{CopyToClipboard}from\"react-copy-to-clipboard\";import ErrorModal from\"../components/ErrorModal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Oracle=/*#__PURE__*/function(_Component){_inherits(Oracle,_Component);var _super=_createSuper(Oracle);function Oracle(props){var _this$state;var _this;_classCallCheck(this,Oracle);_this=_super.call(this,props);_this.onChange=function(_ref){var contractAddrToCopy=_ref.target.contractAddrToCopy;_this.setState({contractAddrToCopy:contractAddrToCopy,copied:false});};_this.onCopy=function(){_this.setState({copied:true});};_this.state=(_this$state={account:_this.props.account,successMsg:\"\",availableEth:\"\",volcanoContract:null,yearEruption:null,monthEruption:null,dayEruption:null,country:\"Iceland\",yearUserInput:\"1727\",monthUserInput:\"08\",dayUserInput:\"03\",yearPresent:null,monthPresent:null,dayPresent:null,latEruption:null,longEruption:null,urlJSON:null,copied:false,value:\"\",chainlinkBalance:\"\",chainlinkContract:\"\",errorMsg:\"\"},_defineProperty(_this$state,\"copied\",false),_defineProperty(_this$state,\"contractAddrToCopy\",CONTRACT_ADDRESS),_defineProperty(_this$state,\"loading\",false),_defineProperty(_this$state,\"loadingVolcanoData\",false),_this$state);return _this;}_createClass(Oracle,[{key:\"componentDidMount\",value:function componentDidMount(){this.loadBlockchainData();this.handleChangeUserInput=this.handleChangeUserInput.bind(this);this.handleRequestTimeNow=this.handleRequestTimeNow.bind(this);this.handleRequestEruptionCoordinates=this.handleRequestEruptionCoordinates.bind(this);console.log(this.props,\"Props in Oracle.js\");}},{key:\"loadBlockchainData\",value:function(){var _loadBlockchainData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var web3,volcanoContract,chainlinkContract;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:web3=new Web3(Web3.givenProvider||\"http://localhost:8545\");//const network = await web3.eth.net.getNetworkType();\n//await window.ethereum.enable();\nvolcanoContract=new web3.eth.Contract(ABI,CONTRACT_ADDRESS);this.setState({volcanoContract:volcanoContract});//Load the chainlink contract\nchainlinkContract=new web3.eth.Contract(CHAINLINK_ABI,CONTRACT_ERC20_CHAINLINK_ADDRESS);this.setState({chainlinkContract:chainlinkContract});this.setInitialValues(volcanoContract,chainlinkContract);this.eventListener(volcanoContract);case 7:case\"end\":return _context.stop();}}},_callee,this);}));function loadBlockchainData(){return _loadBlockchainData.apply(this,arguments);}return loadBlockchainData;}()},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){if(prevProps.account!==this.props.account){this.loadBlockchainData();}}},{key:\"setInitialValues\",value:function setInitialValues(volcanoContract,chainlinkContract){var _this2=this;volcanoContract.methods.YearPresent().call().then(function(res){_this2.setState({yearPresent:res});console.log(_this2.state.yearPresent,\"YEAR present\");});volcanoContract.methods.MonthPresent().call().then(function(res){_this2.setState({monthPresent:res});console.log(_this2.state.monthPresent,\"MONTH present\");});volcanoContract.methods.DayPresent().call().then(function(res){_this2.setState({dayPresent:res});console.log(_this2.state.dayPresent,\"DAY present\");});//get initial long/lats/year/month/day of eruption\nvolcanoContract.methods.YearEruption().call().then(function(res){_this2.setState({yearEruption:res});console.log(_this2.state.yearEruption,\"YEAR eruption\");});volcanoContract.methods.MonthEruption().call().then(function(res){_this2.setState({monthEruption:res});console.log(_this2.state.monthEruption,\"MONTH eruption\");});volcanoContract.methods.DayEruption().call().then(function(res){_this2.setState({dayEruption:res});console.log(_this2.state.dayEruption,\"DAY eruption\");});volcanoContract.methods.LatitudeEruption().call().then(function(res){_this2.setState({latEruption:res});console.log(_this2.state.latEruption,\"latEruption\");});volcanoContract.methods.LongitudeEruption().call().then(function(res){_this2.setState({longEruption:res});console.log(_this2.state.longEruption,\"longEruption\");});//initial state of url\nvolcanoContract.methods.urlRebuiltJSON().call().then(function(res){_this2.setState({urlJSON:res});console.log(_this2.state.urlJSON,\"longEruption\");});//get chainlink balance\nchainlinkContract.methods.balanceOf(CONTRACT_ADDRESS).call().then(function(res){_this2.setState({chainlinkBalance:res});console.log(_this2.state.chainlinkBalance,\"chainlinkBalance\");});}},{key:\"eventListener\",value:function eventListener(volcanoContract){var that=this;volcanoContract.events.eventBlockTime({fromBlock:\"latest\"},function(error,eventResult){}).on(\"data\",function(eventResult){//Call the get function to get the most accurate present state for the value.\nthat.setInitialValues(volcanoContract,that.state.chainlinkContract);//Do a wait 30s here\nthat.setState({loading:false,loadingVolcanoData:false});console.log(\"eventlistner triggered!\");}).on(\"changed\",function(eventResult){// remove event from local database\n}).on(\"error\",console.error);}},{key:\"handleChangeUserInput\",value:function handleChangeUserInput(event){var value=event.target.value;var name=event.target.dataset.name;this.setState(_defineProperty({},name,value));}},{key:\"handleRequestTimeNow\",value:function handleRequestTimeNow(){if(this.props.account[0]){console.log(\"Buuuuu set contract\",this.state.volcanoContract);var web3js=new Web3(window.web3.currentProvider);web3js.eth.sendTransaction({to:CONTRACT_ADDRESS,data:this.state.volcanoContract.methods.OracleRequestPresentTime().encodeABI(),from:this.props.account[0]});//Todo: get the values from eventlistener\n//YearPresent(); MonthPresent(); DayPresent()\nthis.setState({loading:true});}else{this.setState({errorMsg:\"You have to connect to metamask!\"});}}},{key:\"handleRequestEruptionCoordinates\",value:function handleRequestEruptionCoordinates(){if(this.props.account[0]){var _this$state2=this.state,yearUserInput=_this$state2.yearUserInput,monthUserInput=_this$state2.monthUserInput,dayUserInput=_this$state2.dayUserInput,country=_this$state2.country;console.log(yearUserInput,monthUserInput,dayUserInput,\"USER INPUT in handlerequesteruptioncordinates\");var web3js=new Web3(window.web3.currentProvider);web3js.eth.sendTransaction({to:CONTRACT_ADDRESS,data:this.state.volcanoContract.methods.OracleRequestVolcanoEruptionData(yearUserInput,monthUserInput,dayUserInput,country).encodeABI(),from:this.props.account[0]});this.setState({loadingVolcanoData:true});}else{this.setState({errorMsg:\"You have to connect to metamask!\"});}}},{key:\"_whenToRenderSpinner\",value:function _whenToRenderSpinner(){if(this.state.loading){return/*#__PURE__*/_jsx(\"div\",{class:\"spinner-border text-light\",role:\"status\"});}else if(this.state.loadingVolcanoData){return/*#__PURE__*/_jsx(\"div\",{class:\"spinner-border text-light\",role:\"status\"});}}},{key:\"_renderCopyAddress\",value:function _renderCopyAddress(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{className:\"contract-addr\",onChange:this.onChange,disabled:\"true\",value:this.state.contractAddrToCopy}),/*#__PURE__*/_jsx(CopyToClipboard,{onCopy:this.onCopy,text:this.state.contractAddrToCopy,children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-dark-copy\",children:[/*#__PURE__*/_jsx(\"span\",{class:\"sc-jaq3xr-1 doRNia\",children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",\"stroke-width\":\"2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\",children:[/*#__PURE__*/_jsx(\"rect\",{x:\"9\",y:\"9\",width:\"13\",height:\"13\",rx:\"2\",ry:\"2\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"})]})}),\" \",\"Copy Contract Address\"]})})]});}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"App-background\",children:[this.state.errorMsg?/*#__PURE__*/_jsx(ErrorModal,{}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"center-container-buy \",children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:\"center\"},children:\"Oracle\"}),/*#__PURE__*/_jsxs(\"form\",{class:\"form-container-buy\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{class:\"available-eth-container owner\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"CONTRACT ADDRESS\"}),/*#__PURE__*/_jsx(\"div\",{className:\"contract-addr-container\",children:this._renderCopyAddress()}),/*#__PURE__*/_jsxs(\"h6\",{style:{textAlign:\"center\"},className:\"v-txt\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"contract chainlink balance\"}),this.state.chainlinkBalance/1000000000000000000]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"container oracle-get\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"label-input-container\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"lat\",children:\"Current time [GMT]\"}),this.state.loading?/*#__PURE__*/_jsx(\"p\",{style:{textAlign:\"center\"},className:\"v-txt\",children:this._whenToRenderSpinner()}):/*#__PURE__*/_jsx(\"p\",{style:{textAlign:\"center\"},className:\"v-txt\",children:this.state.yearPresent+\"/\"+this.state.monthPresent+\"/\"+this.state.dayPresent})]})}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",class:\"btn btn-dark-request-time\",onClick:this.handleRequestTimeNow,children:[\"Request Time Now\",/*#__PURE__*/_jsx(\"label\",{children:\"[0.05 LINK]\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container oracle-get\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"label-input-container\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"lat\",children:\"Latitude (example 100 = 1.00)\"}),this.state.latEruption]}),/*#__PURE__*/_jsxs(\"div\",{class:\"label-input-container\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"lat\",children:\"Longitude (example 100 = 1.00)\"}),this.state.longEruption]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"container oracle-get\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"label-input-container\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{for:\"lat\",children:\"eruption date\"}),/*#__PURE__*/_jsx(\"p\",{children:this.state.yearEruption+\"/\"+this.state.monthEruption+\"/\"+this.state.dayEruption}),\" \"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"url-container\",children:/*#__PURE__*/_jsx(\"a\",{className:\"url-json\",href:this.state.urlJSON,target:\"_blank\",children:\"Link to Volcano Data\"})}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container oracle\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"label-input-container-oracle\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"lat\",children:\"Year\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Year\",onChange:this.handleChangeUserInput,\"data-name\":\"yearUserInput\",value:this.state.yearUserInput})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"label-input-container-oracle\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"long\",children:\"Month\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Month\",onChange:this.handleChangeUserInput,\"data-name\":\"monthUserInput\",value:this.state.monthUserInput})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"label-input-container-oracle\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"long\",children:\"Day\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Day\",onChange:this.handleChangeUserInput,\"data-name\":\"dayUserInput\",value:this.state.dayUserInput})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"label-input-container-oracle\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"long\",children:\"Country\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Country\",onChange:this.handleChangeUserInput,\"data-name\":\"country\",value:this.state.country})]})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",class:\"btn btn-dark-request-eruption\",onClick:this.handleRequestEruptionCoordinates,children:[\"Request Volcano Eruption Data\",/*#__PURE__*/_jsx(\"label\",{children:\"[0.05 LINK]\"})]}),this.state.loadingVolcanoData?/*#__PURE__*/_jsx(\"p\",{children:this._whenToRenderSpinner()}):null]})]})]});}}]);return Oracle;}(Component);export default Oracle;","map":{"version":3,"sources":["/home/johanna/InsureDisruption/Frontend/insuredisrupt/src/pages/Oracle.js"],"names":["React","Component","Web3","CONTRACT_ADDRESS","ABI","CONTRACT_ERC20_CHAINLINK_ADDRESS","CHAINLINK_ABI","CopyToClipboard","ErrorModal","Oracle","props","onChange","contractAddrToCopy","target","setState","copied","onCopy","state","account","successMsg","availableEth","volcanoContract","yearEruption","monthEruption","dayEruption","country","yearUserInput","monthUserInput","dayUserInput","yearPresent","monthPresent","dayPresent","latEruption","longEruption","urlJSON","value","chainlinkBalance","chainlinkContract","errorMsg","loadBlockchainData","handleChangeUserInput","bind","handleRequestTimeNow","handleRequestEruptionCoordinates","console","log","web3","givenProvider","eth","Contract","setInitialValues","eventListener","prevProps","prevState","methods","YearPresent","call","then","res","MonthPresent","DayPresent","YearEruption","MonthEruption","DayEruption","LatitudeEruption","LongitudeEruption","urlRebuiltJSON","balanceOf","that","events","eventBlockTime","fromBlock","error","eventResult","on","loading","loadingVolcanoData","event","name","dataset","web3js","window","currentProvider","sendTransaction","to","data","OracleRequestPresentTime","encodeABI","from","OracleRequestVolcanoEruptionData","textAlign","_renderCopyAddress","_whenToRenderSpinner"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Web3 from \"web3\";\nimport {\n\tCONTRACT_ADDRESS,\n\tABI,\n\tCONTRACT_ERC20_CHAINLINK_ADDRESS,\n\tCHAINLINK_ABI,\n} from \"../config\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\nimport ErrorModal from \"../components/ErrorModal\";\n\nclass Oracle extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\taccount: this.props.account,\n\t\t\tsuccessMsg: \"\",\n\t\t\tavailableEth: \"\",\n\t\t\tvolcanoContract: null,\n\t\t\tyearEruption: null,\n\t\t\tmonthEruption: null,\n\t\t\tdayEruption: null,\n\t\t\tcountry: \"Iceland\",\n\t\t\tyearUserInput: \"1727\",\n\t\t\tmonthUserInput: \"08\",\n\t\t\tdayUserInput: \"03\",\n\t\t\tyearPresent: null,\n\t\t\tmonthPresent: null,\n\t\t\tdayPresent: null,\n\t\t\tlatEruption: null,\n\t\t\tlongEruption: null,\n\t\t\turlJSON: null,\n\t\t\tcopied: false,\n\t\t\tvalue: \"\",\n\t\t\tchainlinkBalance: \"\",\n\t\t\tchainlinkContract: \"\",\n\t\t\terrorMsg: \"\",\n\t\t\tcopied: false,\n\t\t\tcontractAddrToCopy: CONTRACT_ADDRESS,\n\t\t\tloading: false,\n\t\t\tloadingVolcanoData: false,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadBlockchainData();\n\t\tthis.handleChangeUserInput = this.handleChangeUserInput.bind(this);\n\t\tthis.handleRequestTimeNow = this.handleRequestTimeNow.bind(this);\n\t\tthis.handleRequestEruptionCoordinates =\n\t\t\tthis.handleRequestEruptionCoordinates.bind(this);\n\t\tconsole.log(this.props, \"Props in Oracle.js\");\n\t}\n\n\tasync loadBlockchainData() {\n\t\tconst web3 = new Web3(Web3.givenProvider || \"http://localhost:8545\");\n\t\t//const network = await web3.eth.net.getNetworkType();\n\t\t//await window.ethereum.enable();\n\t\tconst volcanoContract = new web3.eth.Contract(ABI, CONTRACT_ADDRESS);\n\t\tthis.setState({ volcanoContract: volcanoContract });\n\n\t\t//Load the chainlink contract\n\t\tconst chainlinkContract = new web3.eth.Contract(\n\t\t\tCHAINLINK_ABI,\n\t\t\tCONTRACT_ERC20_CHAINLINK_ADDRESS\n\t\t);\n\t\tthis.setState({ chainlinkContract: chainlinkContract });\n\n\t\tthis.setInitialValues(volcanoContract, chainlinkContract);\n\t\tthis.eventListener(volcanoContract);\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (prevProps.account !== this.props.account) {\n\t\t\tthis.loadBlockchainData();\n\t\t}\n\t}\n\n\tsetInitialValues(volcanoContract, chainlinkContract) {\n\t\tvolcanoContract.methods\n\t\t\t.YearPresent()\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ yearPresent: res });\n\t\t\t\tconsole.log(this.state.yearPresent, \"YEAR present\");\n\t\t\t});\n\n\t\tvolcanoContract.methods\n\t\t\t.MonthPresent()\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ monthPresent: res });\n\t\t\t\tconsole.log(this.state.monthPresent, \"MONTH present\");\n\t\t\t});\n\n\t\tvolcanoContract.methods\n\t\t\t.DayPresent()\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ dayPresent: res });\n\t\t\t\tconsole.log(this.state.dayPresent, \"DAY present\");\n\t\t\t});\n\n\t\t//get initial long/lats/year/month/day of eruption\n\t\tvolcanoContract.methods\n\t\t\t.YearEruption()\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ yearEruption: res });\n\t\t\t\tconsole.log(this.state.yearEruption, \"YEAR eruption\");\n\t\t\t});\n\n\t\tvolcanoContract.methods\n\t\t\t.MonthEruption()\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ monthEruption: res });\n\t\t\t\tconsole.log(this.state.monthEruption, \"MONTH eruption\");\n\t\t\t});\n\n\t\tvolcanoContract.methods\n\t\t\t.DayEruption()\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ dayEruption: res });\n\t\t\t\tconsole.log(this.state.dayEruption, \"DAY eruption\");\n\t\t\t});\n\n\t\tvolcanoContract.methods\n\t\t\t.LatitudeEruption()\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ latEruption: res });\n\t\t\t\tconsole.log(this.state.latEruption, \"latEruption\");\n\t\t\t});\n\n\t\tvolcanoContract.methods\n\t\t\t.LongitudeEruption()\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ longEruption: res });\n\t\t\t\tconsole.log(this.state.longEruption, \"longEruption\");\n\t\t\t});\n\n\t\t//initial state of url\n\t\tvolcanoContract.methods\n\t\t\t.urlRebuiltJSON()\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ urlJSON: res });\n\t\t\t\tconsole.log(this.state.urlJSON, \"longEruption\");\n\t\t\t});\n\n\t\t//get chainlink balance\n\t\tchainlinkContract.methods\n\t\t\t.balanceOf(CONTRACT_ADDRESS)\n\t\t\t.call()\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ chainlinkBalance: res });\n\t\t\t\tconsole.log(this.state.chainlinkBalance, \"chainlinkBalance\");\n\t\t\t});\n\t}\n\n\teventListener(volcanoContract) {\n\t\tlet that = this;\n\t\tvolcanoContract.events\n\t\t\t.eventBlockTime(\n\t\t\t\t{\n\t\t\t\t\tfromBlock: \"latest\",\n\t\t\t\t},\n\t\t\t\tfunction (error, eventResult) {}\n\t\t\t)\n\t\t\t.on(\"data\", function (eventResult) {\n\t\t\t\t//Call the get function to get the most accurate present state for the value.\n\t\t\t\tthat.setInitialValues(\n\t\t\t\t\tvolcanoContract,\n\t\t\t\t\tthat.state.chainlinkContract\n\t\t\t\t);\n\n\t\t\t\t//Do a wait 30s here\n\t\t\t\tthat.setState({ loading: false, loadingVolcanoData: false });\n\t\t\t\tconsole.log(\"eventlistner triggered!\");\n\t\t\t})\n\t\t\t.on(\"changed\", function (eventResult) {\n\t\t\t\t// remove event from local database\n\t\t\t})\n\t\t\t.on(\"error\", console.error);\n\t}\n\n\thandleChangeUserInput(event) {\n\t\tlet value = event.target.value;\n\t\tlet name = event.target.dataset.name;\n\t\tthis.setState({ [name]: value });\n\t}\n\n\thandleRequestTimeNow() {\n\t\tif (this.props.account[0]) {\n\t\t\tconsole.log(\"Buuuuu set contract\", this.state.volcanoContract);\n\t\t\tlet web3js = new Web3(window.web3.currentProvider);\n\t\t\tweb3js.eth.sendTransaction({\n\t\t\t\tto: CONTRACT_ADDRESS,\n\t\t\t\tdata: this.state.volcanoContract.methods\n\t\t\t\t\t.OracleRequestPresentTime()\n\t\t\t\t\t.encodeABI(),\n\t\t\t\tfrom: this.props.account[0],\n\t\t\t});\n\t\t\t//Todo: get the values from eventlistener\n\t\t\t//YearPresent(); MonthPresent(); DayPresent()\n\t\t\tthis.setState({ loading: true });\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\terrorMsg: \"You have to connect to metamask!\",\n\t\t\t});\n\t\t}\n\t}\n\n\thandleRequestEruptionCoordinates() {\n\t\tif (this.props.account[0]) {\n\t\t\tconst { yearUserInput, monthUserInput, dayUserInput, country } =\n\t\t\t\tthis.state;\n\t\t\tconsole.log(\n\t\t\t\tyearUserInput,\n\t\t\t\tmonthUserInput,\n\t\t\t\tdayUserInput,\n\t\t\t\t\"USER INPUT in handlerequesteruptioncordinates\"\n\t\t\t);\n\t\t\tlet web3js = new Web3(window.web3.currentProvider);\n\t\t\tweb3js.eth.sendTransaction({\n\t\t\t\tto: CONTRACT_ADDRESS,\n\t\t\t\tdata: this.state.volcanoContract.methods\n\t\t\t\t\t.OracleRequestVolcanoEruptionData(\n\t\t\t\t\t\tyearUserInput,\n\t\t\t\t\t\tmonthUserInput,\n\t\t\t\t\t\tdayUserInput,\n\t\t\t\t\t\tcountry\n\t\t\t\t\t)\n\t\t\t\t\t.encodeABI(),\n\t\t\t\tfrom: this.props.account[0],\n\t\t\t});\n\t\t\tthis.setState({ loadingVolcanoData: true });\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\terrorMsg: \"You have to connect to metamask!\",\n\t\t\t});\n\t\t}\n\t}\n\n\tonChange = ({ target: { contractAddrToCopy } }) => {\n\t\tthis.setState({ contractAddrToCopy, copied: false });\n\t};\n\n\tonCopy = () => {\n\t\tthis.setState({ copied: true });\n\t};\n\n\t_whenToRenderSpinner() {\n\t\tif (this.state.loading) {\n\t\t\treturn <div class=\"spinner-border text-light\" role=\"status\"></div>;\n\t\t} else if (this.state.loadingVolcanoData) {\n\t\t\treturn <div class=\"spinner-border text-light\" role=\"status\"></div>;\n\t\t}\n\t}\n\n\t_renderCopyAddress() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<input\n\t\t\t\t\tclassName=\"contract-addr\"\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tdisabled=\"true\"\n\t\t\t\t\tvalue={this.state.contractAddrToCopy}\n\t\t\t\t/>\n\n\t\t\t\t<CopyToClipboard\n\t\t\t\t\tonCopy={this.onCopy}\n\t\t\t\t\ttext={this.state.contractAddrToCopy}\n\t\t\t\t>\n\t\t\t\t\t<button className=\"btn btn-dark-copy\">\n\t\t\t\t\t\t<span class=\"sc-jaq3xr-1 doRNia\">\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\t\tx=\"9\"\n\t\t\t\t\t\t\t\t\ty=\"9\"\n\t\t\t\t\t\t\t\t\twidth=\"13\"\n\t\t\t\t\t\t\t\t\theight=\"13\"\n\t\t\t\t\t\t\t\t\trx=\"2\"\n\t\t\t\t\t\t\t\t\try=\"2\"\n\t\t\t\t\t\t\t\t></rect>\n\t\t\t\t\t\t\t\t<path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</span>{\" \"}\n\t\t\t\t\t\tCopy Contract Address\n\t\t\t\t\t</button>\n\t\t\t\t</CopyToClipboard>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"App-background\">\n\t\t\t\t{this.state.errorMsg ? <ErrorModal /> : null}\n\t\t\t\t<div className=\"center-container-buy \">\n\t\t\t\t\t<h2 style={{ textAlign: \"center\" }}>Oracle</h2>\n\t\t\t\t\t<form class=\"form-container-buy\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class=\"available-eth-container owner\">\n\t\t\t\t\t\t\t\t<label>CONTRACT ADDRESS</label>\n\t\t\t\t\t\t\t\t<div className=\"contract-addr-container\">\n\t\t\t\t\t\t\t\t\t{this._renderCopyAddress()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<h6\n\t\t\t\t\t\t\t\t\tstyle={{ textAlign: \"center\" }}\n\t\t\t\t\t\t\t\t\tclassName=\"v-txt\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<label>contract chainlink balance</label>\n\t\t\t\t\t\t\t\t\t{this.state.chainlinkBalance /\n\t\t\t\t\t\t\t\t\t\t1000000000000000000}\n\t\t\t\t\t\t\t\t</h6>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"container oracle-get\">\n\t\t\t\t\t\t\t<div class=\"label-input-container\">\n\t\t\t\t\t\t\t\t<label for=\"lat\">Current time [GMT]</label>\n\t\t\t\t\t\t\t\t{this.state.loading ? (\n\t\t\t\t\t\t\t\t\t<p\n\t\t\t\t\t\t\t\t\t\tstyle={{ textAlign: \"center\" }}\n\t\t\t\t\t\t\t\t\t\tclassName=\"v-txt\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{this._whenToRenderSpinner()}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<p\n\t\t\t\t\t\t\t\t\t\tstyle={{ textAlign: \"center\" }}\n\t\t\t\t\t\t\t\t\t\tclassName=\"v-txt\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{this.state.yearPresent +\n\t\t\t\t\t\t\t\t\t\t\t\"/\" +\n\t\t\t\t\t\t\t\t\t\t\tthis.state.monthPresent +\n\t\t\t\t\t\t\t\t\t\t\t\"/\" +\n\t\t\t\t\t\t\t\t\t\t\tthis.state.dayPresent}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclass=\"btn btn-dark-request-time\"\n\t\t\t\t\t\t\tonClick={this.handleRequestTimeNow}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tRequest Time Now\n\t\t\t\t\t\t\t<label>[0.05 LINK]</label>\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div className=\"container oracle-get\">\n\t\t\t\t\t\t\t\t<div class=\"label-input-container\">\n\t\t\t\t\t\t\t\t\t<label for=\"lat\">\n\t\t\t\t\t\t\t\t\t\tLatitude (example 100 = 1.00)\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t{this.state.latEruption}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"label-input-container\">\n\t\t\t\t\t\t\t\t\t<label for=\"lat\">\n\t\t\t\t\t\t\t\t\t\tLongitude (example 100 = 1.00)\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t{this.state.longEruption}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"container oracle-get\">\n\t\t\t\t\t\t\t\t<div class=\"label-input-container\">\n\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t<label for=\"lat\">eruption date</label>\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t{this.state.yearEruption +\n\t\t\t\t\t\t\t\t\t\t\t\"/\" +\n\t\t\t\t\t\t\t\t\t\t\tthis.state.monthEruption +\n\t\t\t\t\t\t\t\t\t\t\t\"/\" +\n\t\t\t\t\t\t\t\t\t\t\tthis.state.dayEruption}\n\t\t\t\t\t\t\t\t\t</p>{\" \"}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"url-container\">\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tclassName=\"url-json\"\n\t\t\t\t\t\t\t\t\thref={this.state.urlJSON}\n\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tLink to Volcano Data\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"container oracle\">\n\t\t\t\t\t\t\t<div class=\"label-input-container-oracle\">\n\t\t\t\t\t\t\t\t<label for=\"lat\">Year</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"Year\"\n\t\t\t\t\t\t\t\t\tonChange={this.handleChangeUserInput}\n\t\t\t\t\t\t\t\t\tdata-name=\"yearUserInput\"\n\t\t\t\t\t\t\t\t\tvalue={this.state.yearUserInput}\n\t\t\t\t\t\t\t\t></input>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"label-input-container-oracle\">\n\t\t\t\t\t\t\t\t<label for=\"long\">Month</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"Month\"\n\t\t\t\t\t\t\t\t\tonChange={this.handleChangeUserInput}\n\t\t\t\t\t\t\t\t\tdata-name=\"monthUserInput\"\n\t\t\t\t\t\t\t\t\tvalue={this.state.monthUserInput}\n\t\t\t\t\t\t\t\t></input>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"label-input-container-oracle\">\n\t\t\t\t\t\t\t\t<label for=\"long\">Day</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"Day\"\n\t\t\t\t\t\t\t\t\tonChange={this.handleChangeUserInput}\n\t\t\t\t\t\t\t\t\tdata-name=\"dayUserInput\"\n\t\t\t\t\t\t\t\t\tvalue={this.state.dayUserInput}\n\t\t\t\t\t\t\t\t></input>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"label-input-container-oracle\">\n\t\t\t\t\t\t\t\t<label for=\"long\">Country</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"Country\"\n\t\t\t\t\t\t\t\t\tonChange={this.handleChangeUserInput}\n\t\t\t\t\t\t\t\t\tdata-name=\"country\"\n\t\t\t\t\t\t\t\t\tvalue={this.state.country}\n\t\t\t\t\t\t\t\t></input>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclass=\"btn btn-dark-request-eruption\"\n\t\t\t\t\t\t\tonClick={this.handleRequestEruptionCoordinates}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tRequest Volcano Eruption Data\n\t\t\t\t\t\t\t<label>[0.05 LINK]</label>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{this.state.loadingVolcanoData ? (\n\t\t\t\t\t\t\t<p>{this._whenToRenderSpinner()}</p>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Oracle;\n"]},"metadata":{},"sourceType":"module"}