{"ast":null,"code":"import _regeneratorRuntime from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/johanna/InsureDisruption/Frontend/insuredisrupt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{CONTRACT_ADDRESS,ABI}from\"../config\";import React,{Component}from\"react\";import Web3 from\"web3\";import logo7 from\"../Images/logo7transparent.png\";import logo8 from\"../Images/LOGO_8_TRANSPARENT.png\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Example=/*#__PURE__*/function(_Component){_inherits(Example,_Component);var _super=_createSuper(Example);function Example(props){var _this;_classCallCheck(this,Example);_this=_super.call(this,props);_this.state={account:\"default\",userGetData:{},userSetData:\"\",todoList:{},storedDataResult:null,userInput:\"\",loading:false};return _this;}_createClass(Example,[{key:\"componentDidMount\",value:function componentDidMount(){this.loadBlockchainData();this.handleSendEth=this.handleSendEth.bind(this);this.handleSetContract=this.handleSetContract.bind(this);this.loadBlockchainData=this.loadBlockchainData.bind(this);this.eventListener=this.eventListener.bind(this);this.handleUserInput=this.handleUserInput.bind(this);}},{key:\"loadBlockchainData\",value:function(){var _loadBlockchainData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;var web3,network,accountFromMetaMask,todoList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:web3=new Web3(Web3.givenProvider||\"http://localhost:8545\");_context.next=3;return web3.eth.net.getNetworkType();case 3:network=_context.sent;_context.next=6;return window.ethereum.enable();case 6:_context.next=8;return web3.eth.getAccounts();case 8:accountFromMetaMask=_context.sent;this.setState({account:accountFromMetaMask});//Load the smart contract\ntodoList=new web3.eth.Contract(ABI,CONTRACT_ADDRESS);this.setState({todoList:todoList});console.log(this.state.todoList,\"\");//Set state for the result from storedData() Q: this is what i did before with await?\ntodoList.methods.storedData().call(function(err,result){if(result===undefined){console.log(err,\"ERR\");}else{_this2.setState({storedDataResult:result});console.log(result,_this2.state.storedDataResult,\"result returned storedData()\");}});///----Event will automatically read data\nthis.eventListener(todoList);case 15:case\"end\":return _context.stop();}}},_callee,this);}));function loadBlockchainData(){return _loadBlockchainData.apply(this,arguments);}return loadBlockchainData;}()},{key:\"eventListener\",value:function eventListener(todoList){var that=this;todoList.events.setValueUpdatedViaWebjs({fromBlock:\"latest\"},function(error,eventResult){}).on(\"data\",function(eventResult){//Call the get function to get the most accurate present state for the value.\ntodoList.methods.storedData().call(function(err,result){that.setState({storedDataResult:result,loading:false});console.log(result,\"Eventlistener result\");});}).on(\"changed\",function(eventResult){// remove event from local database\n}).on(\"error\",console.error);}},{key:\"handleSendEth\",value:function handleSendEth(){console.log(\"Bääääää send eth\");var web3js=new Web3(window.web3.currentProvider);web3js.eth.sendTransaction({to:\"0xc1202e7d42655F23097476f6D48006fE56d38d4f\",from:this.state.account[0],value:web3js.utils.toWei(\"1\",\"ether\")});}},{key:\"handleSetContract\",value:function handleSetContract(){console.log(\"Buuuuu set contract\",this.state.todoList);var web3js=new Web3(window.web3.currentProvider);web3js.eth.sendTransaction({to:CONTRACT_ADDRESS,data:this.state.todoList.methods.set(this.state.userInput).encodeABI(),from:this.state.account[0]});this.setState({loading:true});}},{key:\"_whenToRenderSpinner\",value:function _whenToRenderSpinner(){if(this.state.loading){return/*#__PURE__*/_jsx(\"div\",{class:\"spinner-border text-light\",role:\"status\"});}}},{key:\"handleUserInput\",value:function handleUserInput(event){this.setState({userInput:event.target.value});console.log(this.state.userInput,\"user input handle change\");}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(\"div\",{className:\"App-background\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"center-container \",children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:\"center\"},children:\"Set Contract Data\"}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-container\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-dark\",onClick:this.handleSendEth,children:\"Send Eth\"}),/*#__PURE__*/_jsx(\"input\",{class:\"form-control\",type:\"text\",placeholder:\"Set your value . . . \",onChange:this.handleUserInput,value:this.state.userInput}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-dark\",onClick:this.handleSetContract,children:\"Set contract data\"}),/*#__PURE__*/_jsxs(\"p\",{style:{textAlign:\"center\"},className:\"v-txt\",children:[\"Data you got back from the contract:\",/*#__PURE__*/_jsx(\"h4\",{style:{textAlign:\"center\"},children:\" \"+this.state.storedDataResult})]}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"center\"},children:this._whenToRenderSpinner()})]})]})]})});}}]);return Example;}(Component);export default Example;","map":{"version":3,"sources":["/home/johanna/InsureDisruption/Frontend/insuredisrupt/src/pages/Example.js"],"names":["CONTRACT_ADDRESS","ABI","React","Component","Web3","logo7","logo8","Example","props","state","account","userGetData","userSetData","todoList","storedDataResult","userInput","loading","loadBlockchainData","handleSendEth","bind","handleSetContract","eventListener","handleUserInput","web3","givenProvider","eth","net","getNetworkType","network","window","ethereum","enable","getAccounts","accountFromMetaMask","setState","Contract","console","log","methods","storedData","call","err","result","undefined","that","events","setValueUpdatedViaWebjs","fromBlock","error","eventResult","on","web3js","currentProvider","sendTransaction","to","from","value","utils","toWei","data","set","encodeABI","event","target","textAlign","_whenToRenderSpinner"],"mappings":"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","sourcesContent":["import { CONTRACT_ADDRESS, ABI } from \"../config\";\n\nimport React, { Component } from \"react\";\nimport Web3 from \"web3\";\nimport logo7 from \"../Images/logo7transparent.png\";\nimport logo8 from \"../Images/LOGO_8_TRANSPARENT.png\";\n\nclass Example extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\taccount: \"default\",\n\t\t\tuserGetData: {},\n\t\t\tuserSetData: \"\",\n\t\t\ttodoList: {},\n\t\t\tstoredDataResult: null,\n\t\t\tuserInput: \"\",\n\t\t\tloading: false,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadBlockchainData();\n\t\tthis.handleSendEth = this.handleSendEth.bind(this);\n\t\tthis.handleSetContract = this.handleSetContract.bind(this);\n\t\tthis.loadBlockchainData = this.loadBlockchainData.bind(this);\n\t\tthis.eventListener = this.eventListener.bind(this);\n\t\tthis.handleUserInput = this.handleUserInput.bind(this);\n\t}\n\n\tasync loadBlockchainData() {\n\t\tconst web3 = new Web3(Web3.givenProvider || \"http://localhost:8545\");\n\t\tconst network = await web3.eth.net.getNetworkType();\n\t\tawait window.ethereum.enable();\n\t\t//Fetch account data:\n\t\tconst accountFromMetaMask = await web3.eth.getAccounts();\n\t\tthis.setState({ account: accountFromMetaMask });\n\t\t//Load the smart contract\n\t\tconst todoList = new web3.eth.Contract(ABI, CONTRACT_ADDRESS);\n\t\tthis.setState({ todoList: todoList });\n\t\tconsole.log(this.state.todoList, \"\");\n\n\t\t//Set state for the result from storedData() Q: this is what i did before with await?\n\t\ttodoList.methods.storedData().call((err, result) => {\n\t\t\tif (result === undefined) {\n\t\t\t\tconsole.log(err, \"ERR\");\n\t\t\t} else {\n\t\t\t\tthis.setState({ storedDataResult: result });\n\t\t\t\tconsole.log(\n\t\t\t\t\tresult,\n\t\t\t\t\tthis.state.storedDataResult,\n\t\t\t\t\t\"result returned storedData()\"\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\t///----Event will automatically read data\n\t\tthis.eventListener(todoList);\n\t}\n\n\teventListener(todoList) {\n\t\tlet that = this;\n\t\ttodoList.events\n\t\t\t.setValueUpdatedViaWebjs(\n\t\t\t\t{\n\t\t\t\t\tfromBlock: \"latest\",\n\t\t\t\t},\n\t\t\t\tfunction (error, eventResult) {}\n\t\t\t)\n\t\t\t.on(\"data\", function (eventResult) {\n\t\t\t\t//Call the get function to get the most accurate present state for the value.\n\t\t\t\ttodoList.methods.storedData().call((err, result) => {\n\t\t\t\t\tthat.setState({ storedDataResult: result, loading: false });\n\t\t\t\t\tconsole.log(result, \"Eventlistener result\");\n\t\t\t\t});\n\t\t\t})\n\t\t\t.on(\"changed\", function (eventResult) {\n\t\t\t\t// remove event from local database\n\t\t\t})\n\t\t\t.on(\"error\", console.error);\n\t}\n\n\thandleSendEth() {\n\t\tconsole.log(\"Bääääää send eth\");\n\t\tlet web3js = new Web3(window.web3.currentProvider);\n\t\tweb3js.eth.sendTransaction({\n\t\t\tto: \"0xc1202e7d42655F23097476f6D48006fE56d38d4f\",\n\t\t\tfrom: this.state.account[0],\n\t\t\tvalue: web3js.utils.toWei(\"1\", \"ether\"),\n\t\t});\n\t}\n\n\thandleSetContract() {\n\t\tconsole.log(\"Buuuuu set contract\", this.state.todoList);\n\t\tlet web3js = new Web3(window.web3.currentProvider);\n\t\tweb3js.eth.sendTransaction({\n\t\t\tto: CONTRACT_ADDRESS,\n\t\t\tdata: this.state.todoList.methods\n\t\t\t\t.set(this.state.userInput)\n\t\t\t\t.encodeABI(),\n\t\t\tfrom: this.state.account[0],\n\t\t});\n\n\t\tthis.setState({ loading: true });\n\t}\n\n\t_whenToRenderSpinner() {\n\t\tif (this.state.loading) {\n\t\t\treturn <div class=\"spinner-border text-light\" role=\"status\"></div>;\n\t\t}\n\t}\n\n\thandleUserInput(event) {\n\t\tthis.setState({ userInput: event.target.value });\n\t\tconsole.log(this.state.userInput, \"user input handle change\");\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"App-background\">\n\t\t\t\t<div className=\"center-container \">\n\t\t\t\t\t<h2 style={{ textAlign: \"center\" }}>Set Contract Data</h2>\n\n\t\t\t\t\t<div class=\"form-container\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclass=\"btn btn-dark\"\n\t\t\t\t\t\t\tonClick={this.handleSendEth}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tSend Eth\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\"form-control\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tplaceholder=\"Set your value . . . \"\n\t\t\t\t\t\t\tonChange={this.handleUserInput}\n\t\t\t\t\t\t\tvalue={this.state.userInput}\n\t\t\t\t\t\t></input>\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"btn btn-dark\"\n\t\t\t\t\t\t\t\tonClick={this.handleSetContract}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSet contract data\n\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t<p\n\t\t\t\t\t\t\t\tstyle={{ textAlign: \"center\" }}\n\t\t\t\t\t\t\t\tclassName=\"v-txt\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tData you got back from the contract:\n\t\t\t\t\t\t\t\t<h4 style={{ textAlign: \"center\" }}>\n\t\t\t\t\t\t\t\t\t{\" \" + this.state.storedDataResult}\n\t\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<div style={{ textAlign: \"center\" }}>\n\t\t\t\t\t\t\t\t{this._whenToRenderSpinner()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Example;\n"]},"metadata":{},"sourceType":"module"}